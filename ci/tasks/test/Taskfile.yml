---
version: "3"

includes:
  dev: 
    taskfile: '../dev'
    internal: true

tasks:
  unit:
    desc: Run unit tests
    preconditions:
      - sh: which yarn >/dev/null 2>&1
        msg: Missing "yarn". Please install yarn or use the docker container
    deps:
      - dev:install-packages
    cmds:
      - yarn test
    env:
      CI: true
    sources:
      - 'src/**/*.js'
      - 'src/**/*.ts'
      - 'src/**/*.tsx'
      - 'eslint.config.js'
      - 'package.json'
      - 'tsconfig.json'
      - 'vite-config.ts'
  e2e:
    desc: Run end-to-end tests with playwright
    preconditions:
      - sh: which pytest >/dev/null 2>&1
        msg: Missing "pytest". Please install pytest or use the docker container
      - sh: which playwright >/dev/null 2>&1
        msg: Missing "playwright". Please install playwright or use the docker container
    cmds:
      - pytest "{{.ROOT_DIR}}/test"
    env:
      CI: true
